# Jenkins docker

### 생성

* run.sh 파일을 실행하여 생성 및 실행.
* 이름은 "jenkins17"
* 외부 폴더를 docker 컨테이너의 /var/jenkins_home 폴더로 마운팅해서 사용.  
  외부 폴더의 경로는 원하는 폴더의 경로를 사용하고 주기적으로 백업을 해준다.
* 포트는 다음과 같이 맵핑되어 있음. 적당히 원하는 값으로 변경하여 사용하면 됨.
  * Host:80 => Image:8080
  * Host:50000 => Image:50000
* jenkins_home으로 사용되는 폴더는 자체의 권한은 755 이어야 하며 소유자는 1000:1000 이어야 한다.  
  docker 내부의 계정이 jenkins:jenkins인데 이들의 값이 1000:1000이다.  
  하지만 Host 서버(devsvr)에서의 사용자 1000:1000은 최초 사용자일 것이므로 소유자의 번호가 1000인 사용자를 owner로 해놓으면 된다.
* 권한이 맞지 않아서 실패하는 경우 docker logs 명령으로 로그를 확인하면 touch 명령 실패 로그가 보인다.  
  1000:1000 사용자를 owner로 지정하고 모든 파일(폴더)를 644(755) 권한으로 설정하면 잘된다.

### 중단

* stop.sh 파일을 실행하여 jenkins 서버 종료.

### 시작

* stop.sh으로 종료된 상태에서 start.sh 파일을 실행하여 서버 시작.
* run.sh은 docker image를 생성과 동시에 실행하기 때문에 최초에 한 번만 실행한다.  
  그 이후에는 start.sh로 시작시킨다.

### 참고

* docker image는 하나지만 `jenkins_home` 볼륨을 여러 버전으로 만들어서 개발용, 테스트용, 상용 등의 instance를 따로 띄워서 작업하는 것도 가능하다.
